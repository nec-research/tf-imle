2021-01-31 20:25:45,931	WARNING import_thread.py:132 -- The remote function 'maprop.blackbox.dijkstra.solver' has been exported 100 times. It's possible that this warning is accidental, but this may indicate that the same remote function is being defined repeatedly from within many tasks and exported to all of the workers. This can be a performance issue and can be resolved by defining the remote function on the driver instead. See https://github.com/ray-project/ray/issues/6240 for more discussion.
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(1)
No existing entry for trainer_params.mode.objective_type
{'type': 1}[objective_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.use_marginal
{'type': 1, 'objective_type': 'normal'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 1, 'objective_type': 'normal', 'use_marginal': True}[nb_samples] = <class 'int'>(10)
No existing entry for trainer_params.mode.temperature
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10}[temperature] = <class 'float'>(0.001)
No existing entry for trainer_params.mode.use_gamma
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True}[loss_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.perturb_w
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal'}[perturb_w] = <class 'bool'>(True)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True}[perturb_w_prime] = <class 'bool'>(False)
{'batch_size': 70, 'l1_regconst': 0.0, 'lambda_val': 20.0, 'lr_milestone_1': 30, 'lr_milestone_2': 40, 'model_params': {'arch_params': {}, 'model_name': 'CombResnet18'}, 'neighbourhood_fn': '8-grid', 'optimizer_name': 'Adam', 'optimizer_params': {'lr': 0.0005}, 'preload_batch': True, 'use_cuda': True, 'use_lr_scheduling': True, 'mode': {'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True, 'perturb_w_prime': False}}[lambda_val] = <class 'float'>(50.0)
{'data_dir': 'data/warcraft_shortest_path/12x12', 'evaluate_with_extra': False, 'normalize': True, 'use_local_path': False, 'use_test_set': True}[data_dir] = <class 'str'>(data/warcraft_shortest_path/18x18)
{'evaluate_every': 5, 'loader_params': {'data_dir': 'data/warcraft_shortest_path/18x18', 'evaluate_with_extra': False, 'normalize': True, 'use_local_path': False, 'use_test_set': True}, 'model_dir': 'results/warcraft_shortest_path_combresnet', 'num_cpus': 40, 'num_epochs': 50, 'problem_type': 'warcraft_shortest_path', 'ray_params': {}, 'save_visualizations': False, 'seed': 1, 'trainer_name': 'DijkstraMAP', 'trainer_params': {'batch_size': 70, 'l1_regconst': 0.0, 'lambda_val': 50.0, 'lr_milestone_1': 30, 'lr_milestone_2': 40, 'model_params': {'arch_params': {}, 'model_name': 'CombResnet18'}, 'neighbourhood_fn': '8-grid', 'optimizer_name': 'Adam', 'optimizer_params': {'lr': 0.0005}, 'preload_batch': True, 'use_cuda': True, 'use_lr_scheduling': True, 'mode': {'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True, 'perturb_w_prime': False}}, 'use_ray': True}[seed] = <class 'int'>(3)
{'evaluate_every': 5, 'loader_params': {'data_dir': 'data/warcraft_shortest_path/18x18', 'evaluate_with_extra': False, 'normalize': True, 'use_local_path': False, 'use_test_set': True}, 'model_dir': 'results/warcraft_shortest_path_combresnet', 'num_cpus': 40, 'num_epochs': 50, 'problem_type': 'warcraft_shortest_path', 'ray_params': {}, 'save_visualizations': False, 'seed': 3, 'trainer_name': 'DijkstraMAP', 'trainer_params': {'batch_size': 70, 'l1_regconst': 0.0, 'lambda_val': 50.0, 'lr_milestone_1': 30, 'lr_milestone_2': 40, 'model_params': {'arch_params': {}, 'model_name': 'CombResnet18'}, 'neighbourhood_fn': '8-grid', 'optimizer_name': 'Adam', 'optimizer_params': {'lr': 0.0005}, 'preload_batch': True, 'use_cuda': True, 'use_lr_scheduling': True, 'mode': {'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True, 'perturb_w_prime': False}}, 'use_ray': True}[evaluate_every] = <class 'int'>(1)
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(1)
No existing entry for trainer_params.mode.objective_type
{'type': 1}[objective_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.use_marginal
{'type': 1, 'objective_type': 'normal'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 1, 'objective_type': 'normal', 'use_marginal': True}[nb_samples] = <class 'int'>(10)
No existing entry for trainer_params.mode.temperature
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10}[temperature] = <class 'float'>(0.001)
No existing entry for trainer_params.mode.use_gamma
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True}[loss_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.perturb_w
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal'}[perturb_w] = <class 'bool'>(True)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True}[perturb_w_prime] = <class 'bool'>(False)
{'batch_size': 70, 'l1_regconst': 0.0, 'lambda_val': 20.0, 'lr_milestone_1': 30, 'lr_milestone_2': 40, 'model_params': {'arch_params': {}, 'model_name': 'CombResnet18'}, 'neighbourhood_fn': '8-grid', 'optimizer_name': 'Adam', 'optimizer_params': {'lr': 0.0005}, 'preload_batch': True, 'use_cuda': True, 'use_lr_scheduling': True, 'mode': {'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True, 'perturb_w_prime': False}}[lambda_val] = <class 'float'>(50.0)
{'data_dir': 'data/warcraft_shortest_path/12x12', 'evaluate_with_extra': False, 'normalize': True, 'use_local_path': False, 'use_test_set': True}[data_dir] = <class 'str'>(data/warcraft_shortest_path/18x18)
{'evaluate_every': 5, 'loader_params': {'data_dir': 'data/warcraft_shortest_path/18x18', 'evaluate_with_extra': False, 'normalize': True, 'use_local_path': False, 'use_test_set': True}, 'model_dir': 'results/warcraft_shortest_path_combresnet', 'num_cpus': 40, 'num_epochs': 50, 'problem_type': 'warcraft_shortest_path', 'ray_params': {}, 'save_visualizations': False, 'seed': 1, 'trainer_name': 'DijkstraMAP', 'trainer_params': {'batch_size': 70, 'l1_regconst': 0.0, 'lambda_val': 50.0, 'lr_milestone_1': 30, 'lr_milestone_2': 40, 'model_params': {'arch_params': {}, 'model_name': 'CombResnet18'}, 'neighbourhood_fn': '8-grid', 'optimizer_name': 'Adam', 'optimizer_params': {'lr': 0.0005}, 'preload_batch': True, 'use_cuda': True, 'use_lr_scheduling': True, 'mode': {'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True, 'perturb_w_prime': False}}, 'use_ray': True}[seed] = <class 'int'>(3)
{'evaluate_every': 5, 'loader_params': {'data_dir': 'data/warcraft_shortest_path/18x18', 'evaluate_with_extra': False, 'normalize': True, 'use_local_path': False, 'use_test_set': True}, 'model_dir': 'results/warcraft_shortest_path_combresnet', 'num_cpus': 40, 'num_epochs': 50, 'problem_type': 'warcraft_shortest_path', 'ray_params': {}, 'save_visualizations': False, 'seed': 3, 'trainer_name': 'DijkstraMAP', 'trainer_params': {'batch_size': 70, 'l1_regconst': 0.0, 'lambda_val': 50.0, 'lr_milestone_1': 30, 'lr_milestone_2': 40, 'model_params': {'arch_params': {}, 'model_name': 'CombResnet18'}, 'neighbourhood_fn': '8-grid', 'optimizer_name': 'Adam', 'optimizer_params': {'lr': 0.0005}, 'preload_batch': True, 'use_cuda': True, 'use_lr_scheduling': True, 'mode': {'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 0.001, 'use_gamma': True, 'loss_type': 'normal', 'perturb_w': True, 'perturb_w_prime': False}}, 'use_ray': True}[evaluate_every] = <class 'int'>(1)
{
    "evaluate_every": 1,
    "loader_params": {
        "data_dir": "data/warcraft_shortest_path/18x18",
        "evaluate_with_extra": false,
        "normalize": true,
        "use_local_path": false,
        "use_test_set": true
    },
    "model_dir": "results/warcraft_shortest_path_combresnet",
    "num_cpus": 40,
    "num_epochs": 50,
    "problem_type": "warcraft_shortest_path",
    "ray_params": {},
    "save_visualizations": false,
    "seed": 3,
    "trainer_name": "DijkstraMAP",
    "trainer_params": {
        "batch_size": 70,
        "l1_regconst": 0.0,
        "lambda_val": 50.0,
        "lr_milestone_1": 30,
        "lr_milestone_2": 40,
        "mode": {
            "loss_type": "normal",
            "nb_samples": 10,
            "objective_type": "normal",
            "perturb_w": true,
            "perturb_w_prime": false,
            "temperature": 0.001,
            "type": 1,
            "use_gamma": true,
            "use_marginal": true
        },
        "model_params": {
            "arch_params": {},
            "model_name": "CombResnet18"
        },
        "neighbourhood_fn": "8-grid",
        "optimizer_name": "Adam",
        "optimizer_params": {
            "lr": 0.0005
        },
        "preload_batch": true,
        "use_cuda": true,
        "use_lr_scheduling": true
    },
    "use_ray": true
}
MAP-BACKPROP MODE: {
    "loss_type": "normal",
    "nb_samples": 10,
    "objective_type": "normal",
    "perturb_w": true,
    "perturb_w_prime": false,
    "temperature": 0.001,
    "type": 1,
    "use_gamma": true,
    "use_marginal": true
}
True
META: {'input_image_size': 144, 'output_features': 324, 'num_channels': 3, 'denormalize': <maprop.decorators.input_to_numpy object at 0x2b52015ce5f8>}
EVALUATING
{'loss': 29.7360000038147, 'accuracy': 0.9082222139835358, 'perfect_match_accuracy': 0.008, 'cost_ratio_suggested_true': 2.685205645561218, 'below_10.0_percent_acc': 0.076, 'below_1.0_percent_acc': 0.019, 'below_0.1_percent_acc': 0.016, 'below_0.01_percent_acc': 0.016, 'below_0.001_percent_acc': 0.014, 'below_0.0001_percent_acc': 0.014, 'valid_acc': 1.0}
Epoch: 1	Batch time (1.591005)	Data time (0.024543)	Cuda time (0.000002)	Loss (10.978530)	Accuracy (0.966091)
EVALUATING
{'loss': 6.215000152587891, 'accuracy': 0.9808178973197937, 'perfect_match_accuracy': 0.471, 'cost_ratio_suggested_true': 1.0472779309749602, 'below_10.0_percent_acc': 0.988, 'below_1.0_percent_acc': 0.858, 'below_0.1_percent_acc': 0.82, 'below_0.01_percent_acc': 0.82, 'below_0.001_percent_acc': 0.779, 'below_0.0001_percent_acc': 0.778, 'valid_acc': 1.0}
Epoch: 2	Batch time (1.666167)	Data time (0.027993)	Cuda time (0.000003)	Loss (5.740610)	Accuracy (0.982277)
EVALUATING
{'loss': 5.060000112056732, 'accuracy': 0.9843827009201049, 'perfect_match_accuracy': 0.58, 'cost_ratio_suggested_true': 1.0293833756446837, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.906, 'below_0.1_percent_acc': 0.87, 'below_0.01_percent_acc': 0.87, 'below_0.001_percent_acc': 0.836, 'below_0.0001_percent_acc': 0.836, 'valid_acc': 1.0}
Epoch: 3	Batch time (1.580807)	Data time (0.026835)	Cuda time (0.000002)	Loss (4.969220)	Accuracy (0.984648)
EVALUATING
{'loss': 4.298000137805939, 'accuracy': 0.9867345529794693, 'perfect_match_accuracy': 0.612, 'cost_ratio_suggested_true': 1.0244517588615418, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.942, 'below_0.1_percent_acc': 0.918, 'below_0.01_percent_acc': 0.918, 'below_0.001_percent_acc': 0.867, 'below_0.0001_percent_acc': 0.866, 'valid_acc': 1.0}
Epoch: 4	Batch time (1.444283)	Data time (0.023453)	Cuda time (0.000002)	Loss (4.350460)	Accuracy (0.986561)
EVALUATING
{'loss': 4.440000166893006, 'accuracy': 0.9862962865829468, 'perfect_match_accuracy': 0.597, 'cost_ratio_suggested_true': 1.0249753451347352, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.944, 'below_0.1_percent_acc': 0.912, 'below_0.01_percent_acc': 0.912, 'below_0.001_percent_acc': 0.882, 'below_0.0001_percent_acc': 0.882, 'valid_acc': 1.0}
Epoch: 5	Batch time (1.347130)	Data time (0.024646)	Cuda time (0.000002)	Loss (3.774920)	Accuracy (0.988321)
EVALUATING
{'loss': 3.701000168323517, 'accuracy': 0.9885771477222443, 'perfect_match_accuracy': 0.645, 'cost_ratio_suggested_true': 1.0198546695709227, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.971, 'below_0.1_percent_acc': 0.953, 'below_0.01_percent_acc': 0.953, 'below_0.001_percent_acc': 0.909, 'below_0.0001_percent_acc': 0.909, 'valid_acc': 1.0}
Epoch: 6	Batch time (1.383349)	Data time (0.023001)	Cuda time (0.000002)	Loss (3.551960)	Accuracy (0.989016)
EVALUATING
{'loss': 3.4230001366138456, 'accuracy': 0.9894351696968079, 'perfect_match_accuracy': 0.678, 'cost_ratio_suggested_true': 1.0191988778114318, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.972, 'below_0.1_percent_acc': 0.956, 'below_0.01_percent_acc': 0.956, 'below_0.001_percent_acc': 0.927, 'below_0.0001_percent_acc': 0.927, 'valid_acc': 1.0}
Epoch: 7	Batch time (1.646741)	Data time (0.022038)	Cuda time (0.000002)	Loss (3.499760)	Accuracy (0.989188)
EVALUATING
{'loss': 3.679000132083893, 'accuracy': 0.9886450564861298, 'perfect_match_accuracy': 0.663, 'cost_ratio_suggested_true': 1.0214609861373902, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.963, 'below_0.1_percent_acc': 0.939, 'below_0.01_percent_acc': 0.939, 'below_0.001_percent_acc': 0.894, 'below_0.0001_percent_acc': 0.893, 'valid_acc': 1.0}
Epoch: 8	Batch time (1.574687)	Data time (0.021944)	Cuda time (0.000002)	Loss (3.291560)	Accuracy (0.989824)
EVALUATING
{'loss': 3.437000114917755, 'accuracy': 0.9893919593095779, 'perfect_match_accuracy': 0.678, 'cost_ratio_suggested_true': 1.0251074349880218, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.968, 'below_0.1_percent_acc': 0.947, 'below_0.01_percent_acc': 0.947, 'below_0.001_percent_acc': 0.911, 'below_0.0001_percent_acc': 0.91, 'valid_acc': 1.0}
Epoch: 9	Batch time (1.667633)	Data time (0.025703)	Cuda time (0.000002)	Loss (3.032100)	Accuracy (0.990633)
EVALUATING
{'loss': 4.023000140190124, 'accuracy': 0.9875833213329315, 'perfect_match_accuracy': 0.63, 'cost_ratio_suggested_true': 1.021725037097931, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.965, 'below_0.1_percent_acc': 0.943, 'below_0.01_percent_acc': 0.943, 'below_0.001_percent_acc': 0.901, 'below_0.0001_percent_acc': 0.901, 'valid_acc': 1.0}
Epoch: 10	Batch time (1.636017)	Data time (0.024357)	Cuda time (0.000002)	Loss (2.952950)	Accuracy (0.990880)
EVALUATING
{'loss': 3.8070001125335695, 'accuracy': 0.9882499861717224, 'perfect_match_accuracy': 0.65, 'cost_ratio_suggested_true': 1.0244902634620667, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.962, 'below_0.1_percent_acc': 0.942, 'below_0.01_percent_acc': 0.942, 'below_0.001_percent_acc': 0.892, 'below_0.0001_percent_acc': 0.892, 'valid_acc': 1.0}
Epoch: 11	Batch time (1.664436)	Data time (0.023584)	Cuda time (0.000002)	Loss (2.815470)	Accuracy (0.991311)
EVALUATING
{'loss': 3.4370001053810117, 'accuracy': 0.9893919616937638, 'perfect_match_accuracy': 0.688, 'cost_ratio_suggested_true': 1.0206061291694641, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.967, 'below_0.1_percent_acc': 0.949, 'below_0.01_percent_acc': 0.949, 'below_0.001_percent_acc': 0.917, 'below_0.0001_percent_acc': 0.917, 'valid_acc': 1.0}
Epoch: 12	Batch time (1.613121)	Data time (0.022224)	Cuda time (0.000002)	Loss (2.731820)	Accuracy (0.991558)
EVALUATING
{'loss': 3.69700012922287, 'accuracy': 0.9885894948244095, 'perfect_match_accuracy': 0.66, 'cost_ratio_suggested_true': 1.0189088332653045, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.966, 'below_0.1_percent_acc': 0.944, 'below_0.01_percent_acc': 0.944, 'below_0.001_percent_acc': 0.906, 'below_0.0001_percent_acc': 0.906, 'valid_acc': 1.0}
Epoch: 13	Batch time (1.627850)	Data time (0.022717)	Cuda time (0.000002)	Loss (2.512560)	Accuracy (0.992231)
EVALUATING
{'loss': 3.3860000705718996, 'accuracy': 0.9895493721961975, 'perfect_match_accuracy': 0.68, 'cost_ratio_suggested_true': 1.0185429430007935, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.98, 'below_0.1_percent_acc': 0.962, 'below_0.01_percent_acc': 0.962, 'below_0.001_percent_acc': 0.923, 'below_0.0001_percent_acc': 0.923, 'valid_acc': 1.0}
Epoch: 14	Batch time (1.338235)	Data time (0.021831)	Cuda time (0.000002)	Loss (2.708460)	Accuracy (0.991608)
EVALUATING
{'loss': 3.212000172138214, 'accuracy': 0.9900864070653915, 'perfect_match_accuracy': 0.699, 'cost_ratio_suggested_true': 1.0185118436813354, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.975, 'below_0.1_percent_acc': 0.957, 'below_0.01_percent_acc': 0.957, 'below_0.001_percent_acc': 0.915, 'below_0.0001_percent_acc': 0.915, 'valid_acc': 1.0}
Epoch: 15	Batch time (1.335726)	Data time (0.023369)	Cuda time (0.000002)	Loss (2.513520)	Accuracy (0.992239)
EVALUATING
{'loss': 3.561000096797943, 'accuracy': 0.9890092426538467, 'perfect_match_accuracy': 0.652, 'cost_ratio_suggested_true': 1.0170598030090332, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.976, 'below_0.1_percent_acc': 0.956, 'below_0.01_percent_acc': 0.956, 'below_0.001_percent_acc': 0.924, 'below_0.0001_percent_acc': 0.924, 'valid_acc': 1.0}
Epoch: 16	Batch time (1.506220)	Data time (0.023061)	Cuda time (0.000002)	Loss (2.530420)	Accuracy (0.992206)
EVALUATING
{'loss': 3.172000105381012, 'accuracy': 0.990209863781929, 'perfect_match_accuracy': 0.685, 'cost_ratio_suggested_true': 1.0212462258338928, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.984, 'below_0.1_percent_acc': 0.971, 'below_0.01_percent_acc': 0.971, 'below_0.001_percent_acc': 0.927, 'below_0.0001_percent_acc': 0.927, 'valid_acc': 1.0}
Epoch: 17	Batch time (1.549102)	Data time (0.022442)	Cuda time (0.000002)	Loss (2.370380)	Accuracy (0.992676)
EVALUATING
{'loss': 3.3640001249313354, 'accuracy': 0.9896172761917115, 'perfect_match_accuracy': 0.678, 'cost_ratio_suggested_true': 1.0182655882835387, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.973, 'below_0.1_percent_acc': 0.96, 'below_0.01_percent_acc': 0.96, 'below_0.001_percent_acc': 0.918, 'below_0.0001_percent_acc': 0.918, 'valid_acc': 1.0}
Epoch: 18	Batch time (1.622920)	Data time (0.021724)	Cuda time (0.000002)	Loss (2.446940)	Accuracy (0.992445)
EVALUATING
{'loss': 3.359000109434128, 'accuracy': 0.9896326988935471, 'perfect_match_accuracy': 0.689, 'cost_ratio_suggested_true': 1.0261477553844451, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.98, 'below_0.1_percent_acc': 0.966, 'below_0.01_percent_acc': 0.966, 'below_0.001_percent_acc': 0.927, 'below_0.0001_percent_acc': 0.927, 'valid_acc': 1.0}
Epoch: 19	Batch time (1.619146)	Data time (0.027024)	Cuda time (0.000002)	Loss (2.270710)	Accuracy (0.992985)
EVALUATING
{'loss': 3.1940001595020293, 'accuracy': 0.9901419591903686, 'perfect_match_accuracy': 0.702, 'cost_ratio_suggested_true': 1.0233073472976684, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.984, 'below_0.1_percent_acc': 0.972, 'below_0.01_percent_acc': 0.972, 'below_0.001_percent_acc': 0.925, 'below_0.0001_percent_acc': 0.925, 'valid_acc': 1.0}
Epoch: 20	Batch time (1.648593)	Data time (0.024477)	Cuda time (0.000002)	Loss (2.198810)	Accuracy (0.993192)
EVALUATING
{'loss': 3.3520001363754273, 'accuracy': 0.9896543091535568, 'perfect_match_accuracy': 0.689, 'cost_ratio_suggested_true': 1.020988600254059, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.972, 'below_0.1_percent_acc': 0.956, 'below_0.01_percent_acc': 0.956, 'below_0.001_percent_acc': 0.909, 'below_0.0001_percent_acc': 0.908, 'valid_acc': 1.0}
Epoch: 21	Batch time (1.528531)	Data time (0.025261)	Cuda time (0.000003)	Loss (2.139360)	Accuracy (0.993362)
EVALUATING
{'loss': 3.188000124692917, 'accuracy': 0.9901604801416397, 'perfect_match_accuracy': 0.703, 'cost_ratio_suggested_true': 1.0221063935756682, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.983, 'below_0.1_percent_acc': 0.968, 'below_0.01_percent_acc': 0.968, 'below_0.001_percent_acc': 0.914, 'below_0.0001_percent_acc': 0.914, 'valid_acc': 1.0}
Epoch: 22	Batch time (1.341271)	Data time (0.025337)	Cuda time (0.000003)	Loss (2.205590)	Accuracy (0.993167)
EVALUATING
{'loss': 2.9420001101493836, 'accuracy': 0.9909197354316711, 'perfect_match_accuracy': 0.706, 'cost_ratio_suggested_true': 1.0179036927223206, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.976, 'below_0.1_percent_acc': 0.964, 'below_0.01_percent_acc': 0.964, 'below_0.001_percent_acc': 0.919, 'below_0.0001_percent_acc': 0.919, 'valid_acc': 1.0}
Epoch: 23	Batch time (1.387249)	Data time (0.026383)	Cuda time (0.000002)	Loss (1.965530)	Accuracy (0.993935)
EVALUATING
{'loss': 2.9000000977516174, 'accuracy': 0.9910493683815003, 'perfect_match_accuracy': 0.708, 'cost_ratio_suggested_true': 1.0189501798152925, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.981, 'below_0.1_percent_acc': 0.97, 'below_0.01_percent_acc': 0.97, 'below_0.001_percent_acc': 0.94, 'below_0.0001_percent_acc': 0.94, 'valid_acc': 1.0}
Epoch: 24	Batch time (1.585597)	Data time (0.023163)	Cuda time (0.000002)	Loss (2.084880)	Accuracy (0.993538)
EVALUATING
{'loss': 3.0020000982284545, 'accuracy': 0.9907345604896546, 'perfect_match_accuracy': 0.7, 'cost_ratio_suggested_true': 1.0192317271232605, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.975, 'below_0.1_percent_acc': 0.963, 'below_0.01_percent_acc': 0.963, 'below_0.001_percent_acc': 0.918, 'below_0.0001_percent_acc': 0.918, 'valid_acc': 1.0}
Epoch: 25	Batch time (1.653895)	Data time (0.023400)	Cuda time (0.000003)	Loss (2.040150)	Accuracy (0.993694)
EVALUATING
{'loss': 3.155000104904175, 'accuracy': 0.9902623409032821, 'perfect_match_accuracy': 0.709, 'cost_ratio_suggested_true': 1.0211544489860536, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.975, 'below_0.1_percent_acc': 0.964, 'below_0.01_percent_acc': 0.964, 'below_0.001_percent_acc': 0.93, 'below_0.0001_percent_acc': 0.93, 'valid_acc': 1.0}
Epoch: 26	Batch time (1.624685)	Data time (0.022463)	Cuda time (0.000002)	Loss (2.305470)	Accuracy (0.992863)
EVALUATING
{'loss': 2.940000066757202, 'accuracy': 0.9909259188175201, 'perfect_match_accuracy': 0.733, 'cost_ratio_suggested_true': 1.0175256180763244, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.986, 'below_0.1_percent_acc': 0.966, 'below_0.01_percent_acc': 0.966, 'below_0.001_percent_acc': 0.922, 'below_0.0001_percent_acc': 0.922, 'valid_acc': 1.0}
Epoch: 27	Batch time (1.547151)	Data time (0.021803)	Cuda time (0.000002)	Loss (1.910570)	Accuracy (0.994080)
EVALUATING
{'loss': 3.063000063896179, 'accuracy': 0.990546281337738, 'perfect_match_accuracy': 0.686, 'cost_ratio_suggested_true': 1.0209374952316284, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.983, 'below_0.1_percent_acc': 0.978, 'below_0.01_percent_acc': 0.978, 'below_0.001_percent_acc': 0.936, 'below_0.0001_percent_acc': 0.936, 'valid_acc': 1.0}
Epoch: 28	Batch time (1.663119)	Data time (0.021841)	Cuda time (0.000002)	Loss (1.883630)	Accuracy (0.994168)
EVALUATING
{'loss': 3.2020001006126404, 'accuracy': 0.990117267370224, 'perfect_match_accuracy': 0.701, 'cost_ratio_suggested_true': 1.018060691356659, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.981, 'below_0.1_percent_acc': 0.966, 'below_0.01_percent_acc': 0.966, 'below_0.001_percent_acc': 0.924, 'below_0.0001_percent_acc': 0.923, 'valid_acc': 1.0}
Epoch: 29	Batch time (1.704390)	Data time (0.026101)	Cuda time (0.000002)	Loss (1.806240)	Accuracy (0.994410)
EVALUATING
{'loss': 3.0520001220703126, 'accuracy': 0.9905802363157272, 'perfect_match_accuracy': 0.719, 'cost_ratio_suggested_true': 1.0197616267204284, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.98, 'below_0.1_percent_acc': 0.959, 'below_0.01_percent_acc': 0.959, 'below_0.001_percent_acc': 0.904, 'below_0.0001_percent_acc': 0.904, 'valid_acc': 1.0}
Epoch: 30	Batch time (1.528270)	Data time (0.026306)	Cuda time (0.000002)	Loss (1.778290)	Accuracy (0.994486)
EVALUATING
{'loss': 3.1760001134872438, 'accuracy': 0.990197519659996, 'perfect_match_accuracy': 0.669, 'cost_ratio_suggested_true': 1.0246708476543427, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.984, 'below_0.1_percent_acc': 0.971, 'below_0.01_percent_acc': 0.971, 'below_0.001_percent_acc': 0.922, 'below_0.0001_percent_acc': 0.922, 'valid_acc': 1.0}
Epoch: 31	Batch time (1.344785)	Data time (0.024954)	Cuda time (0.000002)	Loss (1.196260)	Accuracy (0.996283)
EVALUATING
{'loss': 2.5000001335144044, 'accuracy': 0.9922839325666427, 'perfect_match_accuracy': 0.755, 'cost_ratio_suggested_true': 1.0132497930526734, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.99, 'below_0.1_percent_acc': 0.981, 'below_0.01_percent_acc': 0.981, 'below_0.001_percent_acc': 0.935, 'below_0.0001_percent_acc': 0.935, 'valid_acc': 1.0}
Epoch: 32	Batch time (1.344740)	Data time (0.023071)	Cuda time (0.000002)	Loss (0.893830)	Accuracy (0.997244)
EVALUATING
{'loss': 2.5430001008510588, 'accuracy': 0.9921512228250503, 'perfect_match_accuracy': 0.748, 'cost_ratio_suggested_true': 1.013021525144577, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.99, 'below_0.1_percent_acc': 0.98, 'below_0.01_percent_acc': 0.98, 'below_0.001_percent_acc': 0.939, 'below_0.0001_percent_acc': 0.939, 'valid_acc': 1.0}
Epoch: 33	Batch time (1.523289)	Data time (0.021878)	Cuda time (0.000002)	Loss (0.770830)	Accuracy (0.997618)
EVALUATING
{'loss': 2.46000009059906, 'accuracy': 0.9924073886871337, 'perfect_match_accuracy': 0.75, 'cost_ratio_suggested_true': 1.0127853918075562, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.992, 'below_0.1_percent_acc': 0.981, 'below_0.01_percent_acc': 0.981, 'below_0.001_percent_acc': 0.939, 'below_0.0001_percent_acc': 0.939, 'valid_acc': 1.0}
Epoch: 34	Batch time (1.531036)	Data time (0.022391)	Cuda time (0.000002)	Loss (0.733370)	Accuracy (0.997731)
EVALUATING
{'loss': 2.582000079154968, 'accuracy': 0.9920308554172516, 'perfect_match_accuracy': 0.746, 'cost_ratio_suggested_true': 1.0128837597370148, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.99, 'below_0.1_percent_acc': 0.979, 'below_0.01_percent_acc': 0.979, 'below_0.001_percent_acc': 0.936, 'below_0.0001_percent_acc': 0.936, 'valid_acc': 1.0}
Epoch: 35	Batch time (1.541855)	Data time (0.022053)	Cuda time (0.000002)	Loss (0.704450)	Accuracy (0.997830)
EVALUATING
{'loss': 2.5810001146793367, 'accuracy': 0.992033937573433, 'perfect_match_accuracy': 0.74, 'cost_ratio_suggested_true': 1.0134368658065795, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.992, 'below_0.1_percent_acc': 0.982, 'below_0.01_percent_acc': 0.982, 'below_0.001_percent_acc': 0.941, 'below_0.0001_percent_acc': 0.941, 'valid_acc': 1.0}
Epoch: 36	Batch time (1.585759)	Data time (0.021704)	Cuda time (0.000002)	Loss (0.696910)	Accuracy (0.997835)
EVALUATING
{'loss': 2.435000091791153, 'accuracy': 0.9924845546483994, 'perfect_match_accuracy': 0.746, 'cost_ratio_suggested_true': 1.0125288677215576, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.985, 'below_0.01_percent_acc': 0.985, 'below_0.001_percent_acc': 0.944, 'below_0.0001_percent_acc': 0.944, 'valid_acc': 1.0}
Epoch: 37	Batch time (1.620950)	Data time (0.022012)	Cuda time (0.000002)	Loss (0.684930)	Accuracy (0.997855)
EVALUATING
{'loss': 2.6160001337528227, 'accuracy': 0.9919259130954743, 'perfect_match_accuracy': 0.738, 'cost_ratio_suggested_true': 1.0130584371089935, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.995, 'below_0.1_percent_acc': 0.982, 'below_0.01_percent_acc': 0.982, 'below_0.001_percent_acc': 0.941, 'below_0.0001_percent_acc': 0.941, 'valid_acc': 1.0}
Epoch: 38	Batch time (1.511770)	Data time (0.022498)	Cuda time (0.000002)	Loss (0.670100)	Accuracy (0.997930)
EVALUATING
{'loss': 2.6240001118183134, 'accuracy': 0.9919012188911438, 'perfect_match_accuracy': 0.737, 'cost_ratio_suggested_true': 1.0133586204051972, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.995, 'below_0.1_percent_acc': 0.983, 'below_0.01_percent_acc': 0.983, 'below_0.001_percent_acc': 0.94, 'below_0.0001_percent_acc': 0.94, 'valid_acc': 1.0}
Epoch: 39	Batch time (1.327560)	Data time (0.023139)	Cuda time (0.000002)	Loss (0.621070)	Accuracy (0.998081)
EVALUATING
{'loss': 2.408000136613846, 'accuracy': 0.9925678873062134, 'perfect_match_accuracy': 0.749, 'cost_ratio_suggested_true': 1.012832293510437, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.995, 'below_0.1_percent_acc': 0.985, 'below_0.01_percent_acc': 0.985, 'below_0.001_percent_acc': 0.942, 'below_0.0001_percent_acc': 0.942, 'valid_acc': 1.0}
Epoch: 40	Batch time (1.328310)	Data time (0.022511)	Cuda time (0.000002)	Loss (0.649210)	Accuracy (0.997982)
EVALUATING
{'loss': 2.5070001006126406, 'accuracy': 0.9922623360157012, 'perfect_match_accuracy': 0.742, 'cost_ratio_suggested_true': 1.0130335867404938, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.984, 'below_0.01_percent_acc': 0.984, 'below_0.001_percent_acc': 0.941, 'below_0.0001_percent_acc': 0.941, 'valid_acc': 1.0}
Epoch: 41	Batch time (1.635225)	Data time (0.022551)	Cuda time (0.000002)	Loss (0.600310)	Accuracy (0.998131)
EVALUATING
{'loss': 2.423000085353851, 'accuracy': 0.9925215965509415, 'perfect_match_accuracy': 0.75, 'cost_ratio_suggested_true': 1.0126164877414703, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.995, 'below_0.1_percent_acc': 0.986, 'below_0.01_percent_acc': 0.986, 'below_0.001_percent_acc': 0.943, 'below_0.0001_percent_acc': 0.943, 'valid_acc': 1.0}
Epoch: 42	Batch time (1.624469)	Data time (0.022618)	Cuda time (0.000002)	Loss (0.504650)	Accuracy (0.998456)
EVALUATING
{'loss': 2.415000102519989, 'accuracy': 0.9925462883710862, 'perfect_match_accuracy': 0.749, 'cost_ratio_suggested_true': 1.0123766875267028, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.984, 'below_0.01_percent_acc': 0.984, 'below_0.001_percent_acc': 0.943, 'below_0.0001_percent_acc': 0.943, 'valid_acc': 1.0}
Epoch: 43	Batch time (1.637044)	Data time (0.021925)	Cuda time (0.000002)	Loss (0.552350)	Accuracy (0.998312)
EVALUATING
{'loss': 2.3960001027584075, 'accuracy': 0.9926049202680588, 'perfect_match_accuracy': 0.752, 'cost_ratio_suggested_true': 1.0123745167255402, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.985, 'below_0.01_percent_acc': 0.985, 'below_0.001_percent_acc': 0.943, 'below_0.0001_percent_acc': 0.943, 'valid_acc': 1.0}
Epoch: 44	Batch time (1.688769)	Data time (0.026342)	Cuda time (0.000002)	Loss (0.512760)	Accuracy (0.998400)
EVALUATING
{'loss': 2.462000118494034, 'accuracy': 0.9924012213945389, 'perfect_match_accuracy': 0.749, 'cost_ratio_suggested_true': 1.01285662651062, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.983, 'below_0.01_percent_acc': 0.983, 'below_0.001_percent_acc': 0.94, 'below_0.0001_percent_acc': 0.94, 'valid_acc': 1.0}
Epoch: 45	Batch time (1.624834)	Data time (0.023663)	Cuda time (0.000002)	Loss (0.542160)	Accuracy (0.998321)
EVALUATING
{'loss': 2.431000131368637, 'accuracy': 0.9924969005584717, 'perfect_match_accuracy': 0.748, 'cost_ratio_suggested_true': 1.0127519237995148, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.995, 'below_0.1_percent_acc': 0.986, 'below_0.01_percent_acc': 0.986, 'below_0.001_percent_acc': 0.943, 'below_0.0001_percent_acc': 0.943, 'valid_acc': 1.0}
Epoch: 46	Batch time (1.647320)	Data time (0.022328)	Cuda time (0.000002)	Loss (0.445700)	Accuracy (0.998649)
EVALUATING
{'loss': 2.474000105857849, 'accuracy': 0.9923641872406006, 'perfect_match_accuracy': 0.746, 'cost_ratio_suggested_true': 1.0128505659103393, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.993, 'below_0.1_percent_acc': 0.982, 'below_0.01_percent_acc': 0.982, 'below_0.001_percent_acc': 0.943, 'below_0.0001_percent_acc': 0.943, 'valid_acc': 1.0}
Epoch: 47	Batch time (1.674701)	Data time (0.028565)	Cuda time (0.000002)	Loss (0.498210)	Accuracy (0.998481)
EVALUATING
{'loss': 2.4990001106262207, 'accuracy': 0.9922870284318924, 'perfect_match_accuracy': 0.751, 'cost_ratio_suggested_true': 1.0130209803581238, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.993, 'below_0.1_percent_acc': 0.982, 'below_0.01_percent_acc': 0.982, 'below_0.001_percent_acc': 0.941, 'below_0.0001_percent_acc': 0.941, 'valid_acc': 1.0}
Epoch: 48	Batch time (1.431424)	Data time (0.025944)	Cuda time (0.000002)	Loss (0.501230)	Accuracy (0.998439)
EVALUATING
{'loss': 2.4860001015663147, 'accuracy': 0.9923271477222443, 'perfect_match_accuracy': 0.751, 'cost_ratio_suggested_true': 1.012472449541092, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.982, 'below_0.01_percent_acc': 0.982, 'below_0.001_percent_acc': 0.941, 'below_0.0001_percent_acc': 0.941, 'valid_acc': 1.0}
Epoch: 49	Batch time (1.323191)	Data time (0.022939)	Cuda time (0.000002)	Loss (0.493110)	Accuracy (0.998450)
EVALUATING
{'loss': 2.4600000524520875, 'accuracy': 0.9924074000120163, 'perfect_match_accuracy': 0.751, 'cost_ratio_suggested_true': 1.0130728006362915, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.993, 'below_0.1_percent_acc': 0.983, 'below_0.01_percent_acc': 0.983, 'below_0.001_percent_acc': 0.94, 'below_0.0001_percent_acc': 0.94, 'valid_acc': 1.0}
Epoch: 50	Batch time (1.410836)	Data time (0.022361)	Cuda time (0.000002)	Loss (0.469560)	Accuracy (0.998533)
EVALUATING
{'loss': 2.494000117778778, 'accuracy': 0.9923024559020996, 'perfect_match_accuracy': 0.751, 'cost_ratio_suggested_true': 1.0128874790668487, 'below_10.0_percent_acc': 1.0, 'below_1.0_percent_acc': 0.994, 'below_0.1_percent_acc': 0.982, 'below_0.01_percent_acc': 0.982, 'below_0.001_percent_acc': 0.94, 'below_0.0001_percent_acc': 0.94, 'valid_acc': 1.0}
