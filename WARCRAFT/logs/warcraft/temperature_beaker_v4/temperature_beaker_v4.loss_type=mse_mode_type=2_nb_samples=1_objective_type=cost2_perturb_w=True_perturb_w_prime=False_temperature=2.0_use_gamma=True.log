2021-01-11 16:56:14,198	WARNING worker.py:1091 -- The dashboard on node rowlf.local failed with the following error:
Traceback (most recent call last):
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/asyncio/base_events.py", line 1062, in create_server
    sock.bind(sa)
OSError: [Errno 98] Address already in use

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/ray/dashboard/dashboard.py", line 963, in <module>
    dashboard.run()
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/ray/dashboard/dashboard.py", line 577, in run
    aiohttp.web.run_app(self.app, host=self.host, port=self.port)
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/aiohttp/web.py", line 508, in run_app
    loop.run_until_complete(main_task)
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/asyncio/base_events.py", line 484, in run_until_complete
    return future.result()
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/aiohttp/web.py", line 411, in _run_app
    await site.start()
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/aiohttp/web_runner.py", line 128, in start
    reuse_port=self._reuse_port,
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/asyncio/base_events.py", line 1066, in create_server
    % (sa, err.strerror.lower()))
OSError: [Errno 98] error while attempting to bind on address ('127.0.0.1', 8265): address already in use

2021-01-11 16:57:12,780	WARNING import_thread.py:132 -- The remote function 'maprop.blackbox.dijkstra.solver' has been exported 100 times. It's possible that this warning is accidental, but this may indicate that the same remote function is being defined repeatedly from within many tasks and exported to all of the workers. This can be a performance issue and can be resolved by defining the remote function on the driver instead. See https://github.com/ray-project/ray/issues/6240 for more discussion.
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(2)
No existing entry for trainer_params.mode.objective_type
{'type': 2}[objective_type] = <class 'str'>(cost2)
No existing entry for trainer_params.mode.use_marginal
{'type': 2, 'objective_type': 'cost2'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True}[nb_samples] = <class 'int'>(1)
No existing entry for trainer_params.mode.temperature
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1}[temperature] = <class 'float'>(2.0)
No existing entry for trainer_params.mode.scale_temperature_by_path_length
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0}[scale_temperature_by_path_length] = <class 'bool'>(True)
No existing entry for trainer_params.mode.use_gamma
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True, 'use_gamma': True}[loss_type] = <class 'str'>(mse)
No existing entry for trainer_params.mode.perturb_w
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse'}[perturb_w] = <class 'bool'>(True)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse', 'perturb_w': True}[perturb_w_prime] = <class 'bool'>(False)
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(2)
No existing entry for trainer_params.mode.objective_type
{'type': 2}[objective_type] = <class 'str'>(cost2)
No existing entry for trainer_params.mode.use_marginal
{'type': 2, 'objective_type': 'cost2'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True}[nb_samples] = <class 'int'>(1)
No existing entry for trainer_params.mode.temperature
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1}[temperature] = <class 'float'>(2.0)
No existing entry for trainer_params.mode.scale_temperature_by_path_length
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0}[scale_temperature_by_path_length] = <class 'bool'>(True)
No existing entry for trainer_params.mode.use_gamma
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True, 'use_gamma': True}[loss_type] = <class 'str'>(mse)
No existing entry for trainer_params.mode.perturb_w
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse'}[perturb_w] = <class 'bool'>(True)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 2, 'objective_type': 'cost2', 'use_marginal': True, 'nb_samples': 1, 'temperature': 2.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse', 'perturb_w': True}[perturb_w_prime] = <class 'bool'>(False)
{
    "evaluate_every": 5,
    "loader_params": {
        "data_dir": "data/warcraft_shortest_path/12x12",
        "evaluate_with_extra": false,
        "normalize": true,
        "use_local_path": false,
        "use_test_set": true
    },
    "model_dir": "results/warcraft_shortest_path_combresnet",
    "num_cpus": 16,
    "num_epochs": 50,
    "problem_type": "warcraft_shortest_path",
    "ray_params": {},
    "save_visualizations": false,
    "seed": 1,
    "trainer_name": "DijkstraMAP",
    "trainer_params": {
        "batch_size": 70,
        "l1_regconst": 0.0,
        "lambda_val": 20.0,
        "lr_milestone_1": 30,
        "lr_milestone_2": 40,
        "mode": {
            "loss_type": "mse",
            "nb_samples": 1,
            "objective_type": "cost2",
            "perturb_w": true,
            "perturb_w_prime": false,
            "scale_temperature_by_path_length": true,
            "temperature": 2.0,
            "type": 2,
            "use_gamma": true,
            "use_marginal": true
        },
        "model_params": {
            "arch_params": {},
            "model_name": "CombResnet18"
        },
        "neighbourhood_fn": "8-grid",
        "optimizer_name": "Adam",
        "optimizer_params": {
            "lr": 0.0005
        },
        "preload_batch": true,
        "use_cuda": true,
        "use_lr_scheduling": true
    },
    "use_ray": true
}
MAP-BACKPROP MODE: {
    "loss_type": "mse",
    "nb_samples": 1,
    "objective_type": "cost2",
    "perturb_w": true,
    "perturb_w_prime": false,
    "scale_temperature_by_path_length": true,
    "temperature": 2.0,
    "type": 2,
    "use_gamma": true,
    "use_marginal": true
}
True
LOSS FUNCTION: mse
OBJECTIVE TYPE: cost2
META: {'input_image_size': 96, 'output_features': 144, 'num_channels': 3, 'denormalize': <maprop.decorators.input_to_numpy object at 0x2b8efa649630>}
EVALUATING
{'loss': 30939.94849609375, 'accuracy': 0.8786736279726028, 'perfect_match_accuracy': 0.032, 'cost_ratio_suggested_true': 2.4898578476905824, 'below_10.0_percent_acc': 0.128, 'below_1.0_percent_acc': 0.055, 'below_0.1_percent_acc': 0.053, 'below_0.01_percent_acc': 0.053, 'below_0.001_percent_acc': 0.038, 'below_0.0001_percent_acc': 0.038, 'valid_acc': 1.0}
Epoch: 1	Batch time (1.372952)	Data time (0.007360)	Cuda time (0.000002)	Loss (2641.720010)	Accuracy (0.891382)
Epoch: 2	Batch time (1.363078)	Data time (0.007856)	Cuda time (0.000001)	Loss (536.787814)	Accuracy (0.901222)
Epoch: 3	Batch time (1.361812)	Data time (0.006545)	Cuda time (0.000001)	Loss (379.181342)	Accuracy (0.904834)
Epoch: 4	Batch time (1.361476)	Data time (0.006920)	Cuda time (0.000002)	Loss (298.290607)	Accuracy (0.908413)
Epoch: 5	Batch time (1.373145)	Data time (0.006484)	Cuda time (0.000002)	Loss (234.492763)	Accuracy (0.911585)
EVALUATING
{'loss': 207.03209190368653, 'accuracy': 0.9105416786670685, 'perfect_match_accuracy': 0.029, 'cost_ratio_suggested_true': 1.180521354675293, 'below_10.0_percent_acc': 0.928, 'below_1.0_percent_acc': 0.249, 'below_0.1_percent_acc': 0.215, 'below_0.01_percent_acc': 0.215, 'below_0.001_percent_acc': 0.206, 'below_0.0001_percent_acc': 0.206, 'valid_acc': 1.0}
Epoch: 6	Batch time (1.365173)	Data time (0.007182)	Cuda time (0.000002)	Loss (223.068058)	Accuracy (0.912756)
Epoch: 7	Batch time (1.377473)	Data time (0.007901)	Cuda time (0.000002)	Loss (164.563059)	Accuracy (0.917513)
Epoch: 8	Batch time (1.378244)	Data time (0.007816)	Cuda time (0.000003)	Loss (173.776813)	Accuracy (0.917565)
Epoch: 9	Batch time (1.393090)	Data time (0.009275)	Cuda time (0.000002)	Loss (129.195363)	Accuracy (0.921606)
Epoch: 10	Batch time (1.372662)	Data time (0.009531)	Cuda time (0.000002)	Loss (121.418671)	Accuracy (0.921967)
EVALUATING
{'loss': 82.48108905792236, 'accuracy': 0.9207222348451615, 'perfect_match_accuracy': 0.038, 'cost_ratio_suggested_true': 1.152327252626419, 'below_10.0_percent_acc': 0.977, 'below_1.0_percent_acc': 0.378, 'below_0.1_percent_acc': 0.338, 'below_0.01_percent_acc': 0.338, 'below_0.001_percent_acc': 0.328, 'below_0.0001_percent_acc': 0.328, 'valid_acc': 1.0}
Epoch: 11	Batch time (1.368310)	Data time (0.007570)	Cuda time (0.000002)	Loss (111.696302)	Accuracy (0.923212)
Epoch: 12	Batch time (1.370147)	Data time (0.006579)	Cuda time (0.000002)	Loss (100.100101)	Accuracy (0.924251)
Epoch: 13	Batch time (1.376784)	Data time (0.006476)	Cuda time (0.000002)	Loss (96.396985)	Accuracy (0.925437)
Epoch: 14	Batch time (1.371322)	Data time (0.007102)	Cuda time (0.000002)	Loss (81.149190)	Accuracy (0.925394)
Epoch: 15	Batch time (1.387630)	Data time (0.007287)	Cuda time (0.000002)	Loss (71.879532)	Accuracy (0.928789)
EVALUATING
{'loss': 59.69997283935547, 'accuracy': 0.9296180731058121, 'perfect_match_accuracy': 0.058, 'cost_ratio_suggested_true': 1.1345992946624757, 'below_10.0_percent_acc': 0.993, 'below_1.0_percent_acc': 0.508, 'below_0.1_percent_acc': 0.467, 'below_0.01_percent_acc': 0.467, 'below_0.001_percent_acc': 0.451, 'below_0.0001_percent_acc': 0.451, 'valid_acc': 1.0}
Epoch: 16	Batch time (1.366150)	Data time (0.007142)	Cuda time (0.000002)	Loss (68.296744)	Accuracy (0.928969)
Epoch: 17	Batch time (1.358777)	Data time (0.007035)	Cuda time (0.000002)	Loss (64.950740)	Accuracy (0.929644)
Epoch: 18	Batch time (1.376512)	Data time (0.006672)	Cuda time (0.000002)	Loss (58.849940)	Accuracy (0.931131)
Epoch: 19	Batch time (1.360992)	Data time (0.007294)	Cuda time (0.000002)	Loss (51.403960)	Accuracy (0.932210)
Epoch: 20	Batch time (1.359303)	Data time (0.006409)	Cuda time (0.000001)	Loss (59.042037)	Accuracy (0.932456)
EVALUATING
{'loss': 66.75395347595214, 'accuracy': 0.9332639056444169, 'perfect_match_accuracy': 0.075, 'cost_ratio_suggested_true': 1.1340961492061614, 'below_10.0_percent_acc': 0.998, 'below_1.0_percent_acc': 0.609, 'below_0.1_percent_acc': 0.575, 'below_0.01_percent_acc': 0.575, 'below_0.001_percent_acc': 0.562, 'below_0.0001_percent_acc': 0.562, 'valid_acc': 1.0}
Epoch: 21	Batch time (1.352994)	Data time (0.006739)	Cuda time (0.000002)	Loss (48.189953)	Accuracy (0.933745)
Epoch: 22	Batch time (1.347401)	Data time (0.006536)	Cuda time (0.000001)	Loss (44.191242)	Accuracy (0.936717)
Epoch: 23	Batch time (1.370415)	Data time (0.007448)	Cuda time (0.000002)	Loss (47.652954)	Accuracy (0.935442)
Epoch: 24	Batch time (1.351361)	Data time (0.006536)	Cuda time (0.000002)	Loss (41.751646)	Accuracy (0.936358)
Epoch: 25	Batch time (1.347410)	Data time (0.007374)	Cuda time (0.000001)	Loss (41.053850)	Accuracy (0.936203)
EVALUATING
{'loss': 105.55867614746094, 'accuracy': 0.9394583463668823, 'perfect_match_accuracy': 0.087, 'cost_ratio_suggested_true': 1.1387135124206542, 'below_10.0_percent_acc': 0.999, 'below_1.0_percent_acc': 0.738, 'below_0.1_percent_acc': 0.705, 'below_0.01_percent_acc': 0.705, 'below_0.001_percent_acc': 0.687, 'below_0.0001_percent_acc': 0.687, 'valid_acc': 1.0}
Epoch: 26	Batch time (1.350970)	Data time (0.007691)	Cuda time (0.000001)	Loss (46.854020)	Accuracy (0.937911)
Epoch: 27	Batch time (1.351888)	Data time (0.006923)	Cuda time (0.000001)	Loss (35.472031)	Accuracy (0.937644)
Epoch: 28	Batch time (1.350253)	Data time (0.007322)	Cuda time (0.000002)	Loss (35.879565)	Accuracy (0.939790)
Epoch: 29	Batch time (1.352182)	Data time (0.006672)	Cuda time (0.000001)	Loss (32.935279)	Accuracy (0.940710)
Epoch: 30	Batch time (1.353172)	Data time (0.006566)	Cuda time (0.000002)	Loss (32.184359)	Accuracy (0.940732)
EVALUATING
{'loss': 62.107652282714845, 'accuracy': 0.9393680614233016, 'perfect_match_accuracy': 0.097, 'cost_ratio_suggested_true': 1.1375084471702577, 'below_10.0_percent_acc': 0.997, 'below_1.0_percent_acc': 0.823, 'below_0.1_percent_acc': 0.794, 'below_0.01_percent_acc': 0.794, 'below_0.001_percent_acc': 0.773, 'below_0.0001_percent_acc': 0.773, 'valid_acc': 1.0}
Epoch: 31	Batch time (1.365755)	Data time (0.006612)	Cuda time (0.000002)	Loss (19.614659)	Accuracy (0.940747)
Epoch: 32	Batch time (1.361728)	Data time (0.007039)	Cuda time (0.000002)	Loss (16.135663)	Accuracy (0.941408)
Epoch: 33	Batch time (1.358400)	Data time (0.006700)	Cuda time (0.000001)	Loss (15.084173)	Accuracy (0.941425)
Epoch: 34	Batch time (1.368339)	Data time (0.007662)	Cuda time (0.000002)	Loss (15.713862)	Accuracy (0.941705)
Epoch: 35	Batch time (1.365767)	Data time (0.006990)	Cuda time (0.000002)	Loss (13.994134)	Accuracy (0.941983)
EVALUATING
{'loss': 20.63853734970093, 'accuracy': 0.9423888993263244, 'perfect_match_accuracy': 0.11, 'cost_ratio_suggested_true': 1.1275353574752807, 'below_10.0_percent_acc': 0.997, 'below_1.0_percent_acc': 0.829, 'below_0.1_percent_acc': 0.802, 'below_0.01_percent_acc': 0.802, 'below_0.001_percent_acc': 0.782, 'below_0.0001_percent_acc': 0.782, 'valid_acc': 1.0}
Epoch: 36	Batch time (1.357298)	Data time (0.007666)	Cuda time (0.000001)	Loss (13.824830)	Accuracy (0.942162)
Epoch: 37	Batch time (1.342076)	Data time (0.007713)	Cuda time (0.000002)	Loss (14.308775)	Accuracy (0.942295)
Epoch: 38	Batch time (1.361828)	Data time (0.006624)	Cuda time (0.000001)	Loss (13.412291)	Accuracy (0.942181)
Epoch: 39	Batch time (1.358311)	Data time (0.006510)	Cuda time (0.000001)	Loss (13.124758)	Accuracy (0.942568)
Epoch: 40	Batch time (1.359949)	Data time (0.006556)	Cuda time (0.000001)	Loss (13.576690)	Accuracy (0.942654)
EVALUATING
{'loss': 19.45896909713745, 'accuracy': 0.9427013999223709, 'perfect_match_accuracy': 0.108, 'cost_ratio_suggested_true': 1.128979536294937, 'below_10.0_percent_acc': 0.997, 'below_1.0_percent_acc': 0.84, 'below_0.1_percent_acc': 0.815, 'below_0.01_percent_acc': 0.815, 'below_0.001_percent_acc': 0.793, 'below_0.0001_percent_acc': 0.793, 'valid_acc': 1.0}
Epoch: 41	Batch time (1.373818)	Data time (0.007249)	Cuda time (0.000002)	Loss (12.076626)	Accuracy (0.942335)
Epoch: 42	Batch time (1.365396)	Data time (0.007242)	Cuda time (0.000001)	Loss (13.007767)	Accuracy (0.942554)
Epoch: 43	Batch time (1.354916)	Data time (0.006426)	Cuda time (0.000002)	Loss (12.132489)	Accuracy (0.942641)
Epoch: 44	Batch time (1.355415)	Data time (0.007620)	Cuda time (0.000002)	Loss (12.708060)	Accuracy (0.942496)
Epoch: 45	Batch time (1.353245)	Data time (0.007796)	Cuda time (0.000002)	Loss (12.294445)	Accuracy (0.942840)
EVALUATING
{'loss': 19.532236070632933, 'accuracy': 0.9425902861356735, 'perfect_match_accuracy': 0.108, 'cost_ratio_suggested_true': 1.1261914098262786, 'below_10.0_percent_acc': 0.997, 'below_1.0_percent_acc': 0.842, 'below_0.1_percent_acc': 0.815, 'below_0.01_percent_acc': 0.815, 'below_0.001_percent_acc': 0.794, 'below_0.0001_percent_acc': 0.794, 'valid_acc': 1.0}
Epoch: 46	Batch time (1.367170)	Data time (0.007018)	Cuda time (0.000002)	Loss (11.797004)	Accuracy (0.942757)
Epoch: 47	Batch time (1.358239)	Data time (0.007682)	Cuda time (0.000002)	Loss (12.020010)	Accuracy (0.942636)
Epoch: 48	Batch time (1.354144)	Data time (0.006776)	Cuda time (0.000002)	Loss (12.201190)	Accuracy (0.942735)
Epoch: 49	Batch time (1.364038)	Data time (0.006614)	Cuda time (0.000002)	Loss (11.650545)	Accuracy (0.942713)
Epoch: 50	Batch time (1.363476)	Data time (0.007071)	Cuda time (0.000002)	Loss (12.031481)	Accuracy (0.942744)
EVALUATING
{'loss': 18.660893726348878, 'accuracy': 0.9428055691719055, 'perfect_match_accuracy': 0.108, 'cost_ratio_suggested_true': 1.1255435144901276, 'below_10.0_percent_acc': 0.997, 'below_1.0_percent_acc': 0.847, 'below_0.1_percent_acc': 0.819, 'below_0.01_percent_acc': 0.819, 'below_0.001_percent_acc': 0.797, 'below_0.0001_percent_acc': 0.797, 'valid_acc': 1.0}
