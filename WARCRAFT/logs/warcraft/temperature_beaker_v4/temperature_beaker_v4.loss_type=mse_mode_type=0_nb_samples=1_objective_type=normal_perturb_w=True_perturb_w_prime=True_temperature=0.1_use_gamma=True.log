2021-01-15 21:41:01,733	WARNING worker.py:1091 -- The reporter on node gonzo-605-16.local failed with the following error:
Traceback (most recent call last):
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/ray/reporter.py", line 309, in <module>
    reporter.run()
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/ray/reporter.py", line 245, in run
    port = server.add_insecure_port(f"[::]:{self.port}")
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/grpc/_server.py", line 962, in add_insecure_port
    address, _add_insecure_port(self._state, _common.encode(address)))
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/grpc/_common.py", line 166, in validate_port_binding_result
    raise RuntimeError(_ERROR_MESSAGE_PORT_BINDING_FAILED % address)
RuntimeError: Failed to bind to address [::]:42912; set GRPC_VERBOSITY=debug environment variable to see detailed error message.

2021-01-15 21:43:37,332	WARNING import_thread.py:132 -- The remote function 'maprop.blackbox.dijkstra.solver' has been exported 100 times. It's possible that this warning is accidental, but this may indicate that the same remote function is being defined repeatedly from within many tasks and exported to all of the workers. This can be a performance issue and can be resolved by defining the remote function on the driver instead. See https://github.com/ray-project/ray/issues/6240 for more discussion.
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(0)
No existing entry for trainer_params.mode.objective_type
{'type': 0}[objective_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.use_marginal
{'type': 0, 'objective_type': 'normal'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 0, 'objective_type': 'normal', 'use_marginal': True}[nb_samples] = <class 'int'>(1)
No existing entry for trainer_params.mode.temperature
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1}[temperature] = <class 'float'>(0.1)
No existing entry for trainer_params.mode.scale_temperature_by_path_length
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1}[scale_temperature_by_path_length] = <class 'bool'>(True)
No existing entry for trainer_params.mode.use_gamma
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True, 'use_gamma': True}[loss_type] = <class 'str'>(mse)
No existing entry for trainer_params.mode.perturb_w
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse'}[perturb_w] = <class 'bool'>(True)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse', 'perturb_w': True}[perturb_w_prime] = <class 'bool'>(True)
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(0)
No existing entry for trainer_params.mode.objective_type
{'type': 0}[objective_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.use_marginal
{'type': 0, 'objective_type': 'normal'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 0, 'objective_type': 'normal', 'use_marginal': True}[nb_samples] = <class 'int'>(1)
No existing entry for trainer_params.mode.temperature
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1}[temperature] = <class 'float'>(0.1)
No existing entry for trainer_params.mode.scale_temperature_by_path_length
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1}[scale_temperature_by_path_length] = <class 'bool'>(True)
No existing entry for trainer_params.mode.use_gamma
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True, 'use_gamma': True}[loss_type] = <class 'str'>(mse)
No existing entry for trainer_params.mode.perturb_w
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse'}[perturb_w] = <class 'bool'>(True)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 0, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 1, 'temperature': 0.1, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse', 'perturb_w': True}[perturb_w_prime] = <class 'bool'>(True)
{
    "evaluate_every": 5,
    "loader_params": {
        "data_dir": "data/warcraft_shortest_path/12x12",
        "evaluate_with_extra": false,
        "normalize": true,
        "use_local_path": false,
        "use_test_set": true
    },
    "model_dir": "results/warcraft_shortest_path_combresnet",
    "num_cpus": 32,
    "num_epochs": 50,
    "problem_type": "warcraft_shortest_path",
    "ray_params": {},
    "save_visualizations": false,
    "seed": 1,
    "trainer_name": "DijkstraMAP",
    "trainer_params": {
        "batch_size": 70,
        "l1_regconst": 0.0,
        "lambda_val": 20.0,
        "lr_milestone_1": 30,
        "lr_milestone_2": 40,
        "mode": {
            "loss_type": "mse",
            "nb_samples": 1,
            "objective_type": "normal",
            "perturb_w": true,
            "perturb_w_prime": true,
            "scale_temperature_by_path_length": true,
            "temperature": 0.1,
            "type": 0,
            "use_gamma": true,
            "use_marginal": true
        },
        "model_params": {
            "arch_params": {},
            "model_name": "CombResnet18"
        },
        "neighbourhood_fn": "8-grid",
        "optimizer_name": "Adam",
        "optimizer_params": {
            "lr": 0.0005
        },
        "preload_batch": true,
        "use_cuda": true,
        "use_lr_scheduling": true
    },
    "use_ray": true
}
MAP-BACKPROP MODE: {
    "loss_type": "mse",
    "nb_samples": 1,
    "objective_type": "normal",
    "perturb_w": true,
    "perturb_w_prime": true,
    "scale_temperature_by_path_length": true,
    "temperature": 0.1,
    "type": 0,
    "use_gamma": true,
    "use_marginal": true
}
True
LOSS FUNCTION: mse
META: {'input_image_size': 96, 'output_features': 144, 'num_channels': 3, 'denormalize': <maprop.decorators.input_to_numpy object at 0x2aebc731fa20>}
EVALUATING
{'loss': 1204.47, 'accuracy': 0.8786736279726028, 'perfect_match_accuracy': 0.032, 'cost_ratio_suggested_true': 2.4898578476905824, 'below_10.0_percent_acc': 0.128, 'below_1.0_percent_acc': 0.055, 'below_0.1_percent_acc': 0.053, 'below_0.01_percent_acc': 0.053, 'below_0.001_percent_acc': 0.038, 'below_0.0001_percent_acc': 0.038, 'valid_acc': 1.0}
Epoch: 1	Batch time (1.958051)	Data time (0.009021)	Cuda time (0.000003)	Loss (1212.301000)	Accuracy (0.879630)
Epoch: 2	Batch time (1.938357)	Data time (0.007718)	Cuda time (0.000002)	Loss (1205.947000)	Accuracy (0.880263)
Epoch: 3	Batch time (1.932880)	Data time (0.009305)	Cuda time (0.000003)	Loss (1195.847000)	Accuracy (0.881266)
Epoch: 4	Batch time (1.954331)	Data time (0.008383)	Cuda time (0.000002)	Loss (1204.670000)	Accuracy (0.880392)
Epoch: 5	Batch time (1.953634)	Data time (0.007612)	Cuda time (0.000002)	Loss (1196.934000)	Accuracy (0.881145)
EVALUATING
{'loss': 1177.96, 'accuracy': 0.881333349943161, 'perfect_match_accuracy': 0.03, 'cost_ratio_suggested_true': 2.3719997692108152, 'below_10.0_percent_acc': 0.145, 'below_1.0_percent_acc': 0.069, 'below_0.1_percent_acc': 0.061, 'below_0.01_percent_acc': 0.061, 'below_0.001_percent_acc': 0.048, 'below_0.0001_percent_acc': 0.048, 'valid_acc': 1.0}
Epoch: 6	Batch time (1.943290)	Data time (0.008460)	Cuda time (0.000003)	Loss (1194.850000)	Accuracy (0.881360)
Epoch: 7	Batch time (1.943690)	Data time (0.007504)	Cuda time (0.000003)	Loss (1163.563000)	Accuracy (0.884472)
Epoch: 8	Batch time (1.954214)	Data time (0.007385)	Cuda time (0.000002)	Loss (1167.681000)	Accuracy (0.884061)
Epoch: 9	Batch time (1.952957)	Data time (0.007582)	Cuda time (0.000003)	Loss (1170.675000)	Accuracy (0.883762)
Epoch: 10	Batch time (1.952796)	Data time (0.007618)	Cuda time (0.000003)	Loss (1179.291000)	Accuracy (0.882908)
EVALUATING
{'loss': 1142.19, 'accuracy': 0.8849166756868363, 'perfect_match_accuracy': 0.036, 'cost_ratio_suggested_true': 1.97477751493454, 'below_10.0_percent_acc': 0.303, 'below_1.0_percent_acc': 0.122, 'below_0.1_percent_acc': 0.107, 'below_0.01_percent_acc': 0.107, 'below_0.001_percent_acc': 0.091, 'below_0.0001_percent_acc': 0.091, 'valid_acc': 1.0}
Epoch: 11	Batch time (1.956279)	Data time (0.008224)	Cuda time (0.000003)	Loss (1196.846000)	Accuracy (0.881164)
Epoch: 12	Batch time (1.947701)	Data time (0.007372)	Cuda time (0.000003)	Loss (1135.104000)	Accuracy (0.887292)
Epoch: 13	Batch time (1.945749)	Data time (0.007937)	Cuda time (0.000003)	Loss (1181.528000)	Accuracy (0.882683)
Epoch: 14	Batch time (1.951915)	Data time (0.007563)	Cuda time (0.000003)	Loss (1190.514000)	Accuracy (0.881799)
Epoch: 15	Batch time (1.952088)	Data time (0.007696)	Cuda time (0.000003)	Loss (1195.452000)	Accuracy (0.881303)
EVALUATING
{'loss': 1173.23, 'accuracy': 0.8817777860164643, 'perfect_match_accuracy': 0.031, 'cost_ratio_suggested_true': 1.8706952357292175, 'below_10.0_percent_acc': 0.292, 'below_1.0_percent_acc': 0.096, 'below_0.1_percent_acc': 0.088, 'below_0.01_percent_acc': 0.088, 'below_0.001_percent_acc': 0.08, 'below_0.0001_percent_acc': 0.08, 'valid_acc': 1.0}
Epoch: 16	Batch time (1.949259)	Data time (0.007357)	Cuda time (0.000003)	Loss (1170.095000)	Accuracy (0.883815)
Epoch: 17	Batch time (1.936668)	Data time (0.007423)	Cuda time (0.000002)	Loss (1178.530000)	Accuracy (0.882978)
Epoch: 18	Batch time (1.919116)	Data time (0.007178)	Cuda time (0.000003)	Loss (1303.106000)	Accuracy (0.870597)
Epoch: 19	Batch time (1.963620)	Data time (0.007708)	Cuda time (0.000004)	Loss (1418.172000)	Accuracy (0.859182)
Epoch: 20	Batch time (1.969545)	Data time (0.007570)	Cuda time (0.000003)	Loss (1523.131000)	Accuracy (0.848758)
EVALUATING
{'loss': 1443.84, 'accuracy': 0.8547777861356736, 'perfect_match_accuracy': 0.002, 'cost_ratio_suggested_true': 3.2477197813987733, 'below_10.0_percent_acc': 0.064, 'below_1.0_percent_acc': 0.007, 'below_0.1_percent_acc': 0.007, 'below_0.01_percent_acc': 0.007, 'below_0.001_percent_acc': 0.005, 'below_0.0001_percent_acc': 0.005, 'valid_acc': 1.0}
Epoch: 21	Batch time (1.967373)	Data time (0.008864)	Cuda time (0.000002)	Loss (1535.605000)	Accuracy (0.847523)
Epoch: 22	Batch time (1.981534)	Data time (0.008787)	Cuda time (0.000003)	Loss (1434.959000)	Accuracy (0.857515)
Epoch: 23	Batch time (1.978111)	Data time (0.009337)	Cuda time (0.000002)	Loss (1405.439000)	Accuracy (0.860467)
Epoch: 24	Batch time (1.970433)	Data time (0.008691)	Cuda time (0.000002)	Loss (1361.911000)	Accuracy (0.864776)
Epoch: 25	Batch time (1.960285)	Data time (0.009012)	Cuda time (0.000003)	Loss (1327.688000)	Accuracy (0.868146)
EVALUATING
{'loss': 1250.59, 'accuracy': 0.8740486264228821, 'perfect_match_accuracy': 0.026, 'cost_ratio_suggested_true': 2.6441585183143617, 'below_10.0_percent_acc': 0.082, 'below_1.0_percent_acc': 0.037, 'below_0.1_percent_acc': 0.036, 'below_0.01_percent_acc': 0.036, 'below_0.001_percent_acc': 0.028, 'below_0.0001_percent_acc': 0.028, 'valid_acc': 1.0}
Epoch: 26	Batch time (1.968425)	Data time (0.008691)	Cuda time (0.000003)	Loss (1314.366000)	Accuracy (0.869461)
Epoch: 27	Batch time (1.977330)	Data time (0.007586)	Cuda time (0.000002)	Loss (1312.540000)	Accuracy (0.869679)
Epoch: 28	Batch time (1.966181)	Data time (0.007340)	Cuda time (0.000003)	Loss (1320.711000)	Accuracy (0.868869)
Epoch: 29	Batch time (1.964208)	Data time (0.007383)	Cuda time (0.000003)	Loss (1317.478000)	Accuracy (0.869188)
Epoch: 30	Batch time (1.958244)	Data time (0.007584)	Cuda time (0.000002)	Loss (1332.593000)	Accuracy (0.867686)
EVALUATING
{'loss': 1242.28, 'accuracy': 0.8749027901887894, 'perfect_match_accuracy': 0.026, 'cost_ratio_suggested_true': 2.585585181713104, 'below_10.0_percent_acc': 0.095, 'below_1.0_percent_acc': 0.041, 'below_0.1_percent_acc': 0.04, 'below_0.01_percent_acc': 0.04, 'below_0.001_percent_acc': 0.026, 'below_0.0001_percent_acc': 0.026, 'valid_acc': 1.0}
Epoch: 31	Batch time (1.916563)	Data time (0.007316)	Cuda time (0.000002)	Loss (1281.142000)	Accuracy (0.872767)
Epoch: 32	Batch time (1.919406)	Data time (0.007468)	Cuda time (0.000002)	Loss (1270.014000)	Accuracy (0.873904)
Epoch: 33	Batch time (1.906344)	Data time (0.007234)	Cuda time (0.000002)	Loss (1277.515000)	Accuracy (0.873155)
Epoch: 34	Batch time (1.924198)	Data time (0.007327)	Cuda time (0.000002)	Loss (1277.455000)	Accuracy (0.873155)
Epoch: 35	Batch time (1.921223)	Data time (0.007516)	Cuda time (0.000002)	Loss (1271.831000)	Accuracy (0.873725)
EVALUATING
{'loss': 1225.13, 'accuracy': 0.8765694552659988, 'perfect_match_accuracy': 0.023, 'cost_ratio_suggested_true': 2.560048201084137, 'below_10.0_percent_acc': 0.084, 'below_1.0_percent_acc': 0.033, 'below_0.1_percent_acc': 0.032, 'below_0.01_percent_acc': 0.032, 'below_0.001_percent_acc': 0.023, 'below_0.0001_percent_acc': 0.023, 'valid_acc': 1.0}
Epoch: 36	Batch time (1.926907)	Data time (0.007321)	Cuda time (0.000002)	Loss (1251.188000)	Accuracy (0.875773)
Epoch: 37	Batch time (1.921165)	Data time (0.007679)	Cuda time (0.000002)	Loss (1255.943000)	Accuracy (0.875294)
Epoch: 38	Batch time (1.924097)	Data time (0.007408)	Cuda time (0.000003)	Loss (1260.555000)	Accuracy (0.874850)
Epoch: 39	Batch time (1.922040)	Data time (0.007324)	Cuda time (0.000002)	Loss (1262.911000)	Accuracy (0.874599)
Epoch: 40	Batch time (1.927327)	Data time (0.007326)	Cuda time (0.000003)	Loss (1260.075000)	Accuracy (0.874892)
EVALUATING
{'loss': 1251.59, 'accuracy': 0.8739791917800903, 'perfect_match_accuracy': 0.022, 'cost_ratio_suggested_true': 2.6231150341033938, 'below_10.0_percent_acc': 0.083, 'below_1.0_percent_acc': 0.031, 'below_0.1_percent_acc': 0.03, 'below_0.01_percent_acc': 0.03, 'below_0.001_percent_acc': 0.022, 'below_0.0001_percent_acc': 0.022, 'valid_acc': 1.0}
Epoch: 41	Batch time (1.919841)	Data time (0.007473)	Cuda time (0.000002)	Loss (1254.340000)	Accuracy (0.875419)
Epoch: 42	Batch time (1.906934)	Data time (0.007487)	Cuda time (0.000003)	Loss (1255.608000)	Accuracy (0.875333)
Epoch: 43	Batch time (2.132583)	Data time (0.007216)	Cuda time (0.000003)	Loss (1265.817000)	Accuracy (0.874317)
Epoch: 44	Batch time (1.917631)	Data time (0.007337)	Cuda time (0.000003)	Loss (1253.058000)	Accuracy (0.875573)
Epoch: 45	Batch time (1.906058)	Data time (0.007245)	Cuda time (0.000002)	Loss (1255.797000)	Accuracy (0.875308)
EVALUATING
{'loss': 1220.09, 'accuracy': 0.8770694541931152, 'perfect_match_accuracy': 0.027, 'cost_ratio_suggested_true': 2.548880751132965, 'below_10.0_percent_acc': 0.092, 'below_1.0_percent_acc': 0.04, 'below_0.1_percent_acc': 0.039, 'below_0.01_percent_acc': 0.039, 'below_0.001_percent_acc': 0.027, 'below_0.0001_percent_acc': 0.027, 'valid_acc': 1.0}
Epoch: 46	Batch time (2.089808)	Data time (0.007173)	Cuda time (0.000002)	Loss (1251.880000)	Accuracy (0.875694)
Epoch: 47	Batch time (1.926626)	Data time (0.007108)	Cuda time (0.000002)	Loss (1253.256000)	Accuracy (0.875551)
Epoch: 48	Batch time (1.895463)	Data time (0.007164)	Cuda time (0.000002)	Loss (1257.693000)	Accuracy (0.875078)
Epoch: 49	Batch time (1.932772)	Data time (0.007294)	Cuda time (0.000002)	Loss (1242.446000)	Accuracy (0.876644)
Epoch: 50	Batch time (1.934346)	Data time (0.007058)	Cuda time (0.000002)	Loss (1253.716000)	Accuracy (0.875530)
EVALUATING
{'loss': 1219.53, 'accuracy': 0.8771250128746033, 'perfect_match_accuracy': 0.028, 'cost_ratio_suggested_true': 2.5530632448196413, 'below_10.0_percent_acc': 0.087, 'below_1.0_percent_acc': 0.039, 'below_0.1_percent_acc': 0.038, 'below_0.01_percent_acc': 0.038, 'below_0.001_percent_acc': 0.028, 'below_0.0001_percent_acc': 0.028, 'valid_acc': 1.0}
