No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(1)
No existing entry for trainer_params.mode.objective_type
{'type': 1}[objective_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.use_marginal
{'type': 1, 'objective_type': 'normal'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 1, 'objective_type': 'normal', 'use_marginal': True}[nb_samples] = <class 'int'>(10)
No existing entry for trainer_params.mode.temperature
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10}[temperature] = <class 'float'>(1.0)
No existing entry for trainer_params.mode.scale_temperature_by_path_length
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0}[scale_temperature_by_path_length] = <class 'bool'>(True)
No existing entry for trainer_params.mode.use_gamma
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True, 'use_gamma': True}[loss_type] = <class 'str'>(mse)
No existing entry for trainer_params.mode.perturb_w
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse'}[perturb_w] = <class 'bool'>(False)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse', 'perturb_w': False}[perturb_w_prime] = <class 'bool'>(False)
No existing entry for trainer_params.mode.type
{}[type] = <class 'int'>(1)
No existing entry for trainer_params.mode.objective_type
{'type': 1}[objective_type] = <class 'str'>(normal)
No existing entry for trainer_params.mode.use_marginal
{'type': 1, 'objective_type': 'normal'}[use_marginal] = <class 'bool'>(True)
No existing entry for trainer_params.mode.nb_samples
{'type': 1, 'objective_type': 'normal', 'use_marginal': True}[nb_samples] = <class 'int'>(10)
No existing entry for trainer_params.mode.temperature
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10}[temperature] = <class 'float'>(1.0)
No existing entry for trainer_params.mode.scale_temperature_by_path_length
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0}[scale_temperature_by_path_length] = <class 'bool'>(True)
No existing entry for trainer_params.mode.use_gamma
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True}[use_gamma] = <class 'bool'>(True)
No existing entry for trainer_params.mode.loss_type
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True, 'use_gamma': True}[loss_type] = <class 'str'>(mse)
No existing entry for trainer_params.mode.perturb_w
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse'}[perturb_w] = <class 'bool'>(False)
No existing entry for trainer_params.mode.perturb_w_prime
{'type': 1, 'objective_type': 'normal', 'use_marginal': True, 'nb_samples': 10, 'temperature': 1.0, 'scale_temperature_by_path_length': True, 'use_gamma': True, 'loss_type': 'mse', 'perturb_w': False}[perturb_w_prime] = <class 'bool'>(False)
{
    "evaluate_every": 5,
    "loader_params": {
        "data_dir": "data/warcraft_shortest_path/12x12",
        "evaluate_with_extra": false,
        "normalize": true,
        "use_local_path": false,
        "use_test_set": true
    },
    "model_dir": "results/warcraft_shortest_path_combresnet",
    "num_cpus": 24,
    "num_epochs": 50,
    "problem_type": "warcraft_shortest_path",
    "ray_params": {},
    "save_visualizations": false,
    "seed": 1,
    "trainer_name": "DijkstraMAP",
    "trainer_params": {
        "batch_size": 70,
        "l1_regconst": 0.0,
        "lambda_val": 20.0,
        "lr_milestone_1": 30,
        "lr_milestone_2": 40,
        "mode": {
            "loss_type": "mse",
            "nb_samples": 10,
            "objective_type": "normal",
            "perturb_w": false,
            "perturb_w_prime": false,
            "scale_temperature_by_path_length": true,
            "temperature": 1.0,
            "type": 1,
            "use_gamma": true,
            "use_marginal": true
        },
        "model_params": {
            "arch_params": {},
            "model_name": "CombResnet18"
        },
        "neighbourhood_fn": "8-grid",
        "optimizer_name": "Adam",
        "optimizer_params": {
            "lr": 0.0005
        },
        "preload_batch": true,
        "use_cuda": true,
        "use_lr_scheduling": true
    },
    "use_ray": true
}
Traceback (most recent call last):
  File "./cli/warcraft-cli.py", line 176, in <module>
    main()
  File "./cli/warcraft-cli.py", line 151, in main
    **params.trainer_params
  File "/home/pminervi/workspace/map-backprop/maprop/warcraft_shortest_path/maprop.py", line 168, in __init__
    super().__init__(**kwargs)
  File "/home/pminervi/workspace/map-backprop/maprop/warcraft_shortest_path/trainers.py", line 58, in __init__
    self.model.to("cuda")
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/torch/nn/modules/module.py", line 607, in to
    return self._apply(convert)
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/torch/nn/modules/module.py", line 354, in _apply
    module._apply(fn)
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/torch/nn/modules/module.py", line 354, in _apply
    module._apply(fn)
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/torch/nn/modules/module.py", line 376, in _apply
    param_applied = fn(param)
  File "/home/pminervi/anaconda3/envs/gpu/lib/python3.6/site-packages/torch/nn/modules/module.py", line 605, in convert
    return t.to(device, dtype if t.is_floating_point() else None, non_blocking)
RuntimeError: CUDA error: all CUDA-capable devices are busy or unavailable
